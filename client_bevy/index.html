<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pinball2DMulti Bevy Client</title>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: #050510;
      }
      canvas {
        display: block;
        width: 100%;
        height: 100%;
      }
    </style>
    <link
      data-trunk
      rel="rust"
      data-bin="pinball-client-bevy"
      data-wasm-opt="0"
    />
  </head>
  <body>
    <script>
      (() => {
        const attachCanvasFocus = () => {
          const canvas = document.querySelector("canvas");
          if (!canvas) return false;
          if (!canvas.hasAttribute("tabindex")) {
            canvas.setAttribute("tabindex", "0");
          }
          const focusCanvas = () => canvas.focus({ preventScroll: true });
          canvas.addEventListener("pointerdown", focusCanvas);
          window.addEventListener("keydown", (event) => {
            if (
              event.code === "Space" ||
              event.code === "ArrowLeft" ||
              event.code === "ArrowRight"
            ) {
              event.preventDefault();
              focusCanvas();
            }
          });
          setTimeout(focusCanvas, 0);
          return true;
        };

        if (attachCanvasFocus()) return;
        const observer = new MutationObserver(() => {
          if (attachCanvasFocus()) {
            observer.disconnect();
          }
        });
        observer.observe(document.body, { childList: true, subtree: true });
      })();
    </script>
  </body>
</html>
